{% load humanize %}
<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
            <th scope="col">#</th>
            <th scope="col">Transaction Category </th>
            <th scope="col">Date</th>
            <th scope="col">Amount</th>
            <th scope="col">Attachment</th>
            <th scope="col">Note</th>
            <th scope="col">Participants</th>
            </tr>
        </thead>
        <tbody>
            {% for object in objects %}
            <tr>
                <th scope="row">{{object.id}}</th>
                <td>{{object.category}}</td>
                <td>{{object.start_at}}</td>
                {% if object.owner.wallet.limit < object.amount  %}
                <td class="text-danger">{{object.amount|intcomma}}</td>
                {% elif object.owner.wallet.limit > object.amount %}
                <td class="text-success">{{object.amount|intcomma}}</td>
                {% else %}
                <td class="">{{object.amount|intcomma}}</td>
                {% endif %}
                
                <td>{{object.attachment}}</td>
                <td>{{object.note}}</td>
                <td class="users">
                    {% for user in object.users.all %}
                    {% if user == object.owner %}
                    <i class="fa-solid fa-circle-user rounded-circle mt-1 fs-3 text-danger" data-bs-toggle="tooltip" data-bs-placement="top" title="{{user}}:{{user.wallet.limit}}"></i>
                    {% else %}
                    <i class="fa-solid fa-circle-user rounded-circle mt-1 fs-3" data-bs-toggle="tooltip" data-bs-placement="top" title="{{user}}"></i>
                    {% endif %}
                    
                    {% endfor %}
                </td>
                <td>
                    <button class="btn btn-success" onclick="complete({{object.id}})">Complete</button>
                </td>
                </tr>
            {% endfor %}
            
        </tbody>
    </table>
</div>
<script>
    function complete(id)
        {
            $.ajax({
                url : "/request/complete/"+id+"/", // create institution
                //type : "POST", // http method
                //data : formData, // data sent with the post request
                cache: false,
                contentType: false,
                processData: false,
                success : function(res) {
                    
                    window.location.reload();
                          
                },
    
                // handle a non-successful response
                error : function(xhr,errmsg,err) {
                    console.log(err)
                }
            });
        }
        
</script>